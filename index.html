<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />

    <!-- ★PWA/ホーム画面対応（最重要） -->
    <link rel="manifest" href="/manifest.webmanifest" />
    <meta name="theme-color" content="#0b0b0b" />

    <!-- iOS（ホーム画面アイコン & スタンドアロン起動） -->
    <link rel="apple-touch-icon" href="/icons/apple-touch-icon.png" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <meta name="apple-mobile-web-app-title" content="SB RECORD" />

    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>Sparcle Black Log</title>

    <!-- フォントとアイコンの読み込み -->
    <link
      href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700&family=Orbitron:wght@700&display=swap"
      rel="stylesheet"
    >
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
      rel="stylesheet"
    >
  </head>

  <body>
    <!-- ▼▼▼ ログイン画面（認証オーバーレイ） ▼▼▼ -->
    <!-- ★重要：初期は hidden（セッションがある時にログイン画面が出っぱなしを防ぐ） -->
    <div id="authContainer" class="auth-overlay hidden">
      <div class="auth-box">
        <div class="logo-area">
          <img
            src="/images/logo.png"
            alt="Logo"
            class="top-logo"
            style="max-height:60px; margin-bottom:10px;"
            onerror="this.style.display='none'"
          />
          <h1 class="brand-logo" style="font-size:1.8rem;">SPARCLE BLACK</h1>
          <span class="brand-sub">MEMBERS ONLY</span>
        </div>

        <div class="form-group">
          <label>EMAIL</label>
          <input type="email" id="email" placeholder="your@email.com" autocomplete="email">
        </div>

        <div class="form-group">
          <label>PASSWORD</label>
          <input type="password" id="password" placeholder="******** (6文字以上)" autocomplete="current-password">
        </div>

        <!-- ★追加：ログイン画面でのニックネーム入力（任意） -->
        <div class="form-group">
          <label>NICKNAME（初回推奨）</label>
          <input type="text" id="authName" placeholder="例：ローレル" autocomplete="nickname">
        </div>

        <button id="signInBtn" class="submit-btn">LOGIN</button>
        <button
          id="signUpBtn"
          class="save-settings-btn"
          style="margin-top:10px; background:transparent; border:1px solid #444; color:#888;"
        >
          新規登録 (SIGN UP)
        </button>

        <p id="authMessage" style="color:var(--danger); font-size:0.8rem; margin-top:15px; min-height:1.2em;"></p>
      </div>
    </div>
    <!-- ▲▲▲ ログイン画面ここまで ▲▲▲ -->

    <div id="app">
      <!-- ヘッダー -->
      <header>
        <div class="logo-area">
          <img src="/images/logo.png" alt="Logo" class="top-logo" id="topLogoImg" onerror="this.style.display='none'"/>
          <h1 class="brand-logo">SPARCLE BLACK</h1>
          <span class="brand-sub">FISHING RECORD EDITION</span>
        </div>

        <!-- ★右側 -->
        <div style="display:flex; justify-content:center; align-items:center; gap:10px;">
          <div class="user-info" id="userInfoDisplay">GUEST</div>

          <!-- ★バージョン表示 -->
          <span
            id="appVersion"
            style="border:1px solid #333; color:#666; border-radius:4px; padding:2px 8px; font-size:0.75rem; font-family:'Orbitron'; letter-spacing:0.02em;"
            title="App Version"
          >
            Ver.1.0.7 
          </span>

          <!-- ログアウトボタン（初期は非表示） -->
          <button
            id="logoutBtn"
            class="hidden"
            style="background:none; border:1px solid #333; color:#666; border-radius:4px; cursor:pointer; padding:2px 8px;"
            title="Logout"
          >
            <i class="fas fa-sign-out-alt"></i>
          </button>

          <button
            id="appReloadBtn"
            style="background:none; border:1px solid #333; color:#666; border-radius:4px; cursor:pointer; padding:2px 8px;"
            title="Reload"
          >
            <i class="fas fa-sync-alt"></i>
          </button>

          <!-- ★HELP（説明書へ） -->
          <a
            id="helpBtn"
            href="https://note.com/laurelkurodai/n/n0d9b9dbf0696"
            target="_blank"
            rel="noopener noreferrer"
            title="HELP"
            style="background:none; border:1px solid #333; color:#666; border-radius:4px; cursor:pointer; padding:2px 8px; text-decoration:none; display:inline-flex; align-items:center; gap:6px;"
          >
            <i class="fa-solid fa-circle-question"></i>
          </a>
        </div>
      </header>

      <div class="container">
        <div class="tabs">
          <button class="tab-btn active" id="tab-record">LOG</button>
          <button class="tab-btn" id="tab-dashboard">DATA</button>
          <button class="tab-btn" id="tab-settings">SET</button>
        </div>

        <!-- 記録画面 -->
        <div id="recordTab" class="tab-content active">
          <form id="fishingLogForm">

            <!-- ★DATE / TIME（同じ枠にまとめる） -->
            <div class="breakdown-box" style="border-color:#333;">
              <div class="breakdown-header" style="border:none; margin:0;">
                <span>▼ DATE / TIME</span>
              </div>

              <div style="padding-top:10px;">
                <div class="form-group">
                  <label>DATE</label>
                  <input type="date" id="date" required>
                </div>

                <div class="row" style="margin-top:-5px;">
                  <div class="form-group half">
                    <label>START TIME</label>
                    <input type="time" id="startTime" placeholder="--:--">
                  </div>
                  <div class="form-group half">
                    <label>END TIME</label>
                    <input type="time" id="endTime" placeholder="--:--">
                  </div>
                </div>
              </div>
            </div>

            <div class="form-group">
              <label>AREA</label>
              <select id="areaSelect"><option>LOADING...</option></select>
            </div>

            <div class="form-group hidden" id="customAreaGroup">
              <input type="text" id="customAreaInput" placeholder="エリア名を入力">
            </div>

            <div class="form-group">
              <label>LOCATION</label>
              <select id="locationSelect" disabled><option value="">---</option></select>
              <input type="text" id="customLocationInput" class="hidden" placeholder="場所名を入力" style="margin-top:5px;">
            </div>

            <div class="form-group">
              <label>POINT</label>
              <select id="pointSelect" disabled><option value="">---</option></select>
            </div>

            <div class="row">
              <div class="form-group half">
                <label>STYLE</label>
                <select id="method">
                  <option value="ヘチ">ヘチ</option>
                  <option value="メジヘチ">メジヘチ</option>
                  <option value="目印">目印</option>
                  <option value="前打ち">前打ち</option>
                  <option value="その他">その他</option>
                </select>
                <input type="text" id="customMethodInput" class="hidden" placeholder="釣り方を入力" style="margin-top:5px;">
              </div>

              <div class="form-group half">
                <label>MAIN BAIT</label>
                <select id="bait">
                  <option value="イガイ">イガイ</option>
                  <option value="ミジ貝">ミジ貝</option>
                  <option value="フジツボ">フジツボ</option>
                  <option value="パイプ">パイプ</option>
                  <option value="カニ">カニ</option>
                  <option value="赤イソメ">赤イソメ</option>
                  <option value="青コガネ">青コガネ</option>
                  <option value="その他">その他</option>
                </select>
                <input type="text" id="customBaitInput" class="hidden" placeholder="エサを入力" style="margin-top:5px;">
              </div>
            </div>

            <!-- 気象・海況データ（任意・スイッチ式） -->
            <div class="breakdown-box" style="border-color:#333;">
              <div class="breakdown-header" style="border:none; margin:0;">
                <span>▼ CONDITION</span>
                <label class="switch-label">
                  <input type="checkbox" id="conditionSwitch">
                  <span>記録する</span>
                </label>
              </div>

              <div id="conditionContainer" class="hidden">
                <div class="row" style="margin-top:10px;">
                  <div class="form-group half">
                    <label>WEATHER</label>
                    <select id="weatherSelect">
                      <option value="">---</option>
                      <option value="晴れ">晴れ</option>
                      <option value="曇り">曇り</option>
                      <option value="雨">雨</option>
                      <option value="小雨">小雨</option>
                      <option value="その他">その他</option>
                    </select>
                    <input type="text" id="customWeather" class="hidden" placeholder="天気を入力" style="margin-top:5px;">
                  </div>

                  <div class="form-group half">
                    <label>TIDE</label>
                    <select id="tideSelect">
                      <option value="">---</option>
                      <option value="大潮">大潮</option>
                      <option value="中潮">中潮</option>
                      <option value="小潮">小潮</option>
                      <option value="長潮">長潮</option>
                      <option value="若潮">若潮</option>
                    </select>
                  </div>
                </div>

                <div class="form-group">
                  <label>WIND</label>
                  <select id="windSelect">
                    <option value="">---</option>
                    <option value="北">北</option>
                    <option value="北東">北東</option>
                    <option value="東">東</option>
                    <option value="南東">南東</option>
                    <option value="南">南</option>
                    <option value="南西">南西</option>
                    <option value="西">西</option>
                    <option value="北西">北西</option>
                    <option value="無風">無風</option>
                    <option value="爆風">爆風</option>
                    <option value="その他">その他</option>
                  </select>
                  <input type="text" id="customWind" class="hidden" placeholder="風向きを入力" style="margin-top:5px;">
                </div>
              </div>
            </div>

            <div class="form-group">
              <label>釣果数 (TOTAL)</label>
              <select id="count" class="big-input" style="font-size:2rem; font-weight:bold;"></select>
            </div>

            <!-- エサ別内訳（メインベイト自動計算付き） -->
            <div class="breakdown-box">
              <div class="breakdown-header">
                <span>▼ BAIT BREAKDOWN</span>
                <label class="switch-label">
                  <input type="checkbox" id="baitDetailSwitch">
                  <span>詳細入力</span>
                </label>
              </div>

              <div id="baitDetailContainer" class="hidden">
                <div class="row" style="margin-bottom:15px; border-bottom:1px dashed #333; padding-bottom:10px;">
                  <div class="half">
                    <label style="font-size:0.7rem; color:#c5a059;">MAIN BAIT</label>
                    <input type="text" id="displayMainBait" readonly style="background:#111; color:#c5a059; border:none; font-weight:bold; font-family:'Orbitron'; padding:5px 0;">
                  </div>
                  <div class="half">
                    <label style="font-size:0.7rem; color:#c5a059;">COUNT (Auto)</label>
                    <input type="text" id="displayMainBaitCount" readonly style="background:#111; color:#c5a059; border:none; font-weight:bold; font-family:'Orbitron'; font-size:1.2rem; text-align:center; padding:0;">
                  </div>
                </div>

                <p style="font-size:0.7rem; color:#666; margin-bottom:10px;">※メイン以外のエサで釣れた場合に記録</p>

                <div class="row" style="margin-bottom:5px;">
                  <div class="half"><select class="bait-sub-select" id="baitSub1"></select></div>
                  <div class="half"><select class="bait-count-select" id="baitCount1"></select></div>
                </div>
                <div class="row" style="margin-bottom:5px;">
                  <div class="half"><select class="bait-sub-select" id="baitSub2"></select></div>
                  <div class="half"><select class="bait-count-select" id="baitCount2"></select></div>
                </div>
                <div class="row">
                  <div class="half"><select class="bait-sub-select" id="baitSub3"></select></div>
                  <div class="half"><select class="bait-count-select" id="baitCount3"></select></div>
                </div>
              </div>
            </div>

            <!-- サイズ内訳ボックス -->
            <div class="breakdown-box">
              <div class="breakdown-header">
                <span>▼ SIZE BREAKDOWN</span>
                <label class="switch-label">
                  <input type="checkbox" id="detailModeSwitch">
                  <span style="font-size:0.7rem;">詳細サイズ(40/45)も記録</span>
                </label>
              </div>

              <div class="form-group">
                <label class="gold-text">↳ うち、年無し (50cm over)</label>
                <select id="toshinashi" class="big-input gold-border"></select>
              </div>

              <div class="row hidden" id="detailSizeInputs">
                <div class="form-group half">
                  <label style="color:#cf4545;">↳ うち、45~49cm</label>
                  <select id="size45" class="big-input" style="border-color:#cf4545;"></select>
                </div>
                <div class="form-group half">
                  <label style="color:#4a90e2;">↳ うち、40~44cm</label>
                  <select id="size40" class="big-input" style="border-color:#4a90e2;"></select>
                </div>
              </div>
            </div>

            <div class="form-group">
              <label>MEMO</label>
              <textarea id="memo" rows="3"></textarea>
            </div>

            <button type="button" class="submit-btn" id="submitBtn">RECORD LOG</button>
          </form>
        </div>

        <!-- 集計画面 -->
        <div id="dashboardTab" class="tab-content">
          <div class="filter-area">
            <h4><i class="fas fa-filter"></i> FILTER</h4>

            <div class="row">
              <div class="form-group half">
                <label>START DATE</label>
                <input type="date" id="filterStartDate">
              </div>
              <div class="form-group half">
                <label>END DATE</label>
                <input type="date" id="filterEndDate">
              </div>
            </div>

            <div class="row">
              <div class="form-group half">
                <label>AREA</label>
                <select id="filterAreaSelect">
                  <option value="">ALL AREAS</option>
                </select>
              </div>
              <div class="form-group half">
                <label>LOCATION</label>
                <select id="filterLocationSelect" disabled>
                  <option value="">ALL LOCATIONS</option>
                </select>
              </div>
            </div>

            <div class="dashboard-controls">
              <button class="refresh-btn" id="applyFilterBtn">APPLY & RELOAD</button>
              <button class="csv-btn" id="exportBtn">EXPORT CSV</button>
            </div>
          </div>

          <div class="stats-summary">
            <div class="stat-card"><h3>TOTAL</h3><p id="totalCatch">0</p></div>
            <div class="stat-card highlight"><h3>TOSHINASHI</h3><p id="totalToshinashi">0</p></div>
          </div>

          <div class="chart-container"><canvas id="monthlyChart"></canvas></div>

          <div class="row" id="chartRow">
            <div class="half">
              <div class="chart-container" style="height:250px; padding:10px;">
                <h5 style="text-align:center; color:#888; margin-bottom:5px;">BAIT RATIO</h5>
                <canvas id="baitPieChart"></canvas>
              </div>
            </div>
            <div class="half">
              <div class="chart-container" style="height:250px; padding:10px;">
                <h5 style="text-align:center; color:#888; margin-bottom:5px;">AREA RATIO</h5>
                <canvas id="areaPieChart"></canvas>
              </div>
            </div>
          </div>

          <div class="row" id="chartRow2" style="margin-top:10px;">
            <div class="half">
              <div class="chart-container" style="height:250px; padding:10px;">
                <h5 style="text-align:center; color:#888; margin-bottom:5px;">WEATHER</h5>
                <canvas id="weatherPieChart"></canvas>
              </div>
            </div>
            <div class="half">
              <div class="chart-container" style="height:250px; padding:10px;">
                <h5 style="text-align:center; color:#888; margin-bottom:5px;">TIDE</h5>
                <canvas id="tidePieChart"></canvas>
              </div>
            </div>
          </div>

          <div class="row" id="chartRow3" style="margin-top:10px;">
            <div class="half">
              <div class="chart-container" style="height:250px; padding:10px;">
                <h5 style="text-align:center; color:#888; margin-bottom:5px;">WIND</h5>
                <canvas id="windPieChart"></canvas>
              </div>
            </div>
          </div>

          <div class="recent-logs">
            <h3>LOGS (<span id="logCount">0</span>)</h3>
            <ul id="logList"></ul>
          </div>
        </div>

        <!-- 設定画面 -->
        <div id="settingsTab" class="tab-content">
          <div class="settings-group">
            <h3>ACCOUNT INFO</h3>
            <p style="color:#888; font-size:0.8rem; margin-bottom:5px;">LOGGED IN AS:</p>
            <p id="currentUserEmail" style="color:#fff; font-family:'Orbitron'; font-size:1.1rem; margin-bottom:20px;">---</p>

            <div class="form-group">
              <label>NICKNAME</label>
              <input type="text" id="userNameInput" placeholder="例: ローレル" autocomplete="nickname">
              <button class="save-settings-btn" id="saveProfileBtn" style="margin-top:5px;">UPDATE NAME</button>
            </div>
          </div>

          <div class="settings-group" style="border-color: var(--danger);">
            <h3 style="color:var(--danger);">DANGER ZONE</h3>
            <p style="font-size:0.8rem; color:#888; margin-bottom:10px;">
              表示中のデータを全て消去します。<br>この操作は取り消せません。
            </p>
            <button class="save-settings-btn btn-danger" id="openDeleteAllModalBtn">DELETE ALL DATA</button>
          </div>
        </div>
      </div>
    </div>

    <!-- 編集用モーダル -->
    <div id="editModal" class="modal hidden">
      <div class="modal-content">
        <h3>EDIT LOG</h3>
        <input type="hidden" id="editLogId">

        <!-- 互換用：旧main.tsが参照しても落ちないように残す（UIでは使わない） -->
        <input type="hidden" id="editLocation" value="">

        <!-- ★DATE / TIME（EDIT） -->
        <div class="breakdown-box" style="border-color:#333; margin-top:10px;">
          <div class="breakdown-header" style="border:none; margin:0;">
            <span>▼ DATE / TIME</span>
          </div>

          <div style="padding-top:10px;">
            <div class="form-group">
              <label>DATE</label>
              <input type="date" id="editDate">
            </div>

            <div class="row" style="margin-top:-5px;">
              <div class="form-group half">
                <label>START TIME</label>
                <input type="time" id="editStartTime" placeholder="--:--">
              </div>
              <div class="form-group half">
                <label>END TIME</label>
                <input type="time" id="editEndTime" placeholder="--:--">
              </div>
            </div>
          </div>
        </div>

        <!-- ★EDIT: AREA / LOCATION / POINT（手書き廃止） -->
        <div class="breakdown-box" style="border-color:#333; margin-top:14px;">
          <div class="breakdown-header" style="border:none; margin:0;">
            <span>▼ AREA / LOCATION / POINT</span>
          </div>

          <div style="padding-top:10px;">
            <div class="form-group">
              <label>AREA</label>
              <select id="editAreaSelect"><option>LOADING...</option></select>
            </div>

            <div class="form-group hidden" id="editCustomAreaGroup">
              <input type="text" id="editCustomAreaInput" placeholder="エリア名を入力">
            </div>

            <div class="form-group">
              <label>LOCATION</label>
              <select id="editLocationSelect" disabled><option value="">---</option></select>
              <input type="text" id="editCustomLocationInput" class="hidden" placeholder="場所名を入力" style="margin-top:5px;">
            </div>

            <div class="form-group">
              <label>POINT</label>
              <select id="editPointSelect" disabled><option value="">---</option></select>
            </div>

            <p style="font-size:0.7rem; color:#666; margin-top:6px;">
              ※EDITでは手書き修正は行いません（選択式で統一）
            </p>
          </div>
        </div>

        <!-- ★EDIT: STYLE / BAIT（ドラム式＋その他） -->
        <div class="row" style="margin-top:10px;">
          <div class="form-group half">
            <label>STYLE</label>
            <select id="editMethod">
              <option value="ヘチ">ヘチ</option>
              <option value="メジヘチ">メジヘチ</option>
              <option value="目印">目印</option>
              <option value="前打ち">前打ち</option>
              <option value="その他">その他</option>
            </select>
            <input type="text" id="editCustomMethodInput" class="hidden" placeholder="釣り方を入力" style="margin-top:5px;">
          </div>

          <div class="form-group half">
            <label>MAIN BAIT</label>
            <select id="editBait">
              <option value="イガイ">イガイ</option>
              <option value="ミジ貝">ミジ貝</option>
              <option value="フジツボ">フジツボ</option>
              <option value="パイプ">パイプ</option>
              <option value="カニ">カニ</option>
              <option value="赤イソメ">赤イソメ</option>
              <option value="青コガネ">青コガネ</option>
              <option value="その他">その他</option>
            </select>
            <input type="text" id="editCustomBaitInput" class="hidden" placeholder="エサを入力" style="margin-top:5px;">
          </div>
        </div>

        <!-- ★EDIT: 数値（ドラム式） -->
        <div class="row" style="margin-top:10px;">
          <div class="form-group half">
            <label>TOTAL</label>
            <select id="editCount" class="big-input" style="font-size:2rem; font-weight:bold;"></select>
          </div>
          <div class="form-group half">
            <label class="gold-text">OVER 50</label>
            <select id="editToshinashi" class="big-input gold-border"></select>
          </div>
        </div>

        <div class="row" style="margin-top:10px;">
          <div class="form-group half">
            <label style="color:#cf4545;">45-49</label>
            <select id="editSize45" class="big-input" style="border-color:#cf4545;"></select>
          </div>
          <div class="form-group half">
            <label style="color:#4a90e2;">40-44</label>
            <select id="editSize40" class="big-input" style="border-color:#4a90e2;"></select>
          </div>
        </div>

        <!-- ★EDIT: CONDITION -->
        <div class="breakdown-box" style="border-color:#333; margin-top:14px;">
          <div class="breakdown-header" style="border:none; margin:0;">
            <span>▼ CONDITION</span>
          </div>

          <div style="padding-top:10px;">
            <div class="row">
              <div class="form-group half">
                <label>WEATHER</label>
                <select id="editWeatherSelect">
                  <option value="">---</option>
                  <option value="晴れ">晴れ</option>
                  <option value="曇り">曇り</option>
                  <option value="雨">雨</option>
                  <option value="小雨">小雨</option>
                  <option value="その他">その他</option>
                </select>
                <input type="text" id="editCustomWeather" class="hidden" placeholder="天気を入力" style="margin-top:5px;">
              </div>

              <div class="form-group half">
                <label>TIDE</label>
                <select id="editTideSelect">
                  <option value="">---</option>
                  <option value="大潮">大潮</option>
                  <option value="中潮">中潮</option>
                  <option value="小潮">小潮</option>
                  <option value="長潮">長潮</option>
                  <option value="若潮">若潮</option>
                </select>
              </div>
            </div>

            <div class="form-group">
              <label>WIND</label>
              <select id="editWindSelect">
                <option value="">---</option>
                <option value="北">北</option>
                <option value="北東">北東</option>
                <option value="東">東</option>
                <option value="南東">南東</option>
                <option value="南">南</option>
                <option value="南西">南西</option>
                <option value="西">西</option>
                <option value="北西">北西</option>
                <option value="無風">無風</option>
                <option value="爆風">爆風</option>
                <option value="その他">その他</option>
              </select>
              <input type="text" id="editCustomWind" class="hidden" placeholder="風向きを入力" style="margin-top:5px;">
            </div>
          </div>
        </div>

        <!-- ★EDIT: BAIT BREAKDOWN -->
        <div class="breakdown-box" style="margin-top:14px;">
          <div class="breakdown-header">
            <span>▼ BAIT BREAKDOWN</span>
            <label class="switch-label">
              <input type="checkbox" id="editBaitDetailSwitch">
              <span>詳細入力</span>
            </label>
          </div>

          <div id="editBaitDetailContainer" class="hidden">
            <div class="row" style="margin-bottom:12px; border-bottom:1px dashed #333; padding-bottom:10px;">
              <div class="half">
                <label style="font-size:0.7rem; color:#c5a059;">MAIN BAIT</label>
                <input type="text" id="editDisplayMainBait" readonly style="background:#111; color:#c5a059; border:none; font-weight:bold; font-family:'Orbitron'; padding:5px 0;">
              </div>
              <div class="half">
                <label style="font-size:0.7rem; color:#c5a059;">COUNT (Auto)</label>
                <input type="text" id="editDisplayMainBaitCount" readonly style="background:#111; color:#c5a059; border:none; font-weight:bold; font-family:'Orbitron'; font-size:1.2rem; text-align:center; padding:0;">
              </div>
            </div>

            <p style="font-size:0.7rem; color:#666; margin-bottom:10px;">※メイン以外のエサで釣れた場合に記録</p>

            <div class="row" style="margin-bottom:5px;">
              <div class="half"><select class="bait-sub-select" id="editBaitSub1"></select></div>
              <div class="half"><select class="bait-count-select" id="editBaitCount1"></select></div>
            </div>
            <div class="row" style="margin-bottom:5px;">
              <div class="half"><select class="bait-sub-select" id="editBaitSub2"></select></div>
              <div class="half"><select class="bait-count-select" id="editBaitCount2"></select></div>
            </div>
            <div class="row">
              <div class="half"><select class="bait-sub-select" id="editBaitSub3"></select></div>
              <div class="half"><select class="bait-count-select" id="editBaitCount3"></select></div>
            </div>

            <p id="editBaitDetailError" style="color:var(--danger); font-size:0.8rem; margin-top:10px; min-height:1.2em;"></p>
          </div>
        </div>

        <div class="form-group">
          <label>MEMO</label>
          <textarea id="editMemo" rows="3"></textarea>
        </div>

        <div class="modal-actions">
          <button class="cancel-btn" id="closeModalBtn">CANCEL</button>
          <button class="save-btn" id="updateLogBtn">UPDATE</button>
        </div>
      </div>
    </div>

    <!-- 削除確認用モーダル（個別削除） -->
    <div id="confirmModal" class="modal hidden">
      <div class="modal-content" style="max-width:350px; text-align:center;">
        <h3 style="color:#fff;">CONFIRMATION</h3>
        <p style="margin-bottom:20px; color:#ccc;">本当に削除しますか？<br>この操作は取り消せません。</p>
        <div class="modal-actions">
          <button class="cancel-btn" id="cancelDeleteBtn">CANCEL</button>
          <button class="save-btn btn-danger" id="confirmDeleteBtn">DELETE</button>
        </div>
      </div>
    </div>

    <!-- 全削除専用モーダル -->
    <div id="deleteAllModal" class="modal hidden">
      <div class="modal-content" style="border-color:var(--danger); text-align:center;">
        <h3 style="color:var(--danger); margin-bottom:10px;">WARNING</h3>
        <p style="color:#fff; font-weight:bold; margin-bottom:10px;">全データを削除しますか？</p>
        <p style="font-size:0.8rem; color:#ccc; margin-bottom:20px;">
          この操作は取り消せません。<br>
          本当に削除してよければ実行してください。
        </p>
        <div class="modal-actions">
          <button class="cancel-btn" id="cancelDeleteAllModalBtn">CANCEL</button>
          <button class="save-btn btn-danger" id="executeDeleteAllBtn">EXECUTE DELETE</button>
        </div>
      </div>
    </div>

    <!-- ★強制ニックネーム設定モーダル -->
    <div id="nicknameModal" class="modal hidden">
      <div class="modal-content" style="max-width:380px;">
        <h3 style="color:#fff; text-align:center;">NICKNAME REQUIRED</h3>
        <p style="margin:12px 0 16px; color:#ccc; font-size:0.85rem; line-height:1.6;">
          初回はニックネーム設定が必要です。<br>
          （あとで変更OK。同一人物の判定はユーザーID(UUID)で行います）
        </p>

        <div class="form-group">
          <label>NICKNAME</label>
          <input type="text" id="nicknameModalInput" placeholder="例：ローレル" autocomplete="nickname">
          <p style="color:#888; font-size:0.75rem; margin-top:6px;">※空欄のまま保存できません</p>
        </div>

        <div class="modal-actions">
          <button class="cancel-btn" id="nicknameLogoutBtn">LOGOUT</button>
          <button class="save-btn btn-danger" id="nicknameSaveBtn">SAVE</button>
        </div>
      </div>
    </div>

    <!-- トースト通知 -->
    <div id="toast" class="toast"></div>

    <script type="module" src="/src/main.ts"></script>
  </body>
</html>
