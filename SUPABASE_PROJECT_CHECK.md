# 【重要】練習環境と本番環境は同じSupabaseプロジェクト？

## 🤔 まず確認すること

練習環境（record-fishing-practice）と本番環境（record-fishing）が**同じSupabaseプロジェクト**を使っているかどうかを確認しましょう。

---

## 📝 確認方法

### 方法1: 練習環境の.envファイルを確認

練習環境の`.env`ファイルを開いて、URLを確認：

```env
VITE_SUPABASE_URL=https://knmwrjywhhjojlmzfbtf.supabase.co
```

この URL が、本番環境でも使われているかどうかを確認します。

### 方法2: Supabaseダッシュボードで確認

1. https://supabase.com/dashboard にログイン
2. プロジェクト一覧を確認
3. プロジェクトが**1つだけ**なら、練習環境と本番環境は同じプロジェクトを使っている

---

## 🎯 ケース別の対応方法

### ケース1: 同じSupabaseプロジェクトを使っている場合（推奨）

**結論**: `.env`ファイルを書き換える必要は**ありません**！

#### やること

1. ✅ GitHubから練習環境のコードをダウンロード
2. ✅ **何も書き換えない**（.envファイルはそのまま）
3. ✅ ZIPにまとめる
4. ✅ 本番アプリのチャットにアップロード

**超簡単！**

---

### ケース2: 別々のSupabaseプロジェクトを使っている場合

練習用と本番用で別々のSupabaseプロジェクトを使っている場合は、`.env`ファイルを書き換える必要があります。

この場合は、`ENV_FILE_GUIDE_SIMPLE.md` を参照してください。

---

## 🔍 どちらのケースか見分ける方法

### 簡単な確認方法

#### 1. Supabaseのプロジェクト数を確認

https://supabase.com/dashboard にログインして、プロジェクト一覧を見る

- **プロジェクトが1つだけ**: → ケース1（同じプロジェクト）
- **プロジェクトが2つ以上**:
  - 「record-fishing-practice」と「record-fishing」がある → ケース2（別々のプロジェクト）
  - 「record-fishing」だけある → ケース1（同じプロジェクト）

#### 2. データを確認

練習環境（https://record-fishing-practice.pages.dev）と本番環境（https://record-fishing.pages.dev）で：

- **同じデータが表示される**: → ケース1（同じプロジェクト）
- **別々のデータが表示される**: → ケース2（別々のプロジェクト）

---

## 📋 移行手順（ケース別）

### ✅ ケース1の場合（同じSupabaseプロジェクト）

```
1. GitHubからコードをダウンロード（5分）
   ↓
2. 不要なフォルダを削除（node_modules、dist、.git）（2分）
   ↓
3. ZIPにまとめる（2分）
   ↓
4. 本番アプリのチャットにアップロード（10分）
   ↓
5. SQL実行（スキップ！すでにマイグレーション済み）
   ↓
6. 動作確認（3分）
```

**合計: 約22分**

**重要**: SQLを実行する必要は**ありません**！練習環境でテストした時点で、すでにSupabaseのテーブルは更新されています。

---

### ✅ ケース2の場合（別々のSupabaseプロジェクト）

```
1. GitHubからコードをダウンロード（5分）
   ↓
2. .env ファイルを本番用に書き換え（5分）
   ↓
3. 不要なフォルダを削除（2分）
   ↓
4. ZIPにまとめる（2分）
   ↓
5. 本番アプリのチャットにアップロード（10分）
   ↓
6. 本番Supabaseで SQL実行（5分）← 必要！
   ↓
7. 動作確認（3分）
```

**合計: 約32分**

---

## 🎯 推奨: ケース1で運用する理由

### メリット

1. ✅ **データベースが1つだけ**: 管理が簡単
2. ✅ **SQLを実行する必要なし**: マイグレーション不要
3. ✅ **練習環境でテストしたらすぐ本番反映**: 開発が早い
4. ✅ **費用が1プロジェクト分だけ**: Supabaseの無料枠を使い切らない

### デメリット

1. ❌ **練習環境と本番環境のデータが同じ**: テストデータと本番データが混ざる
2. ❌ **練習環境で失敗すると本番にも影響**: テストは慎重に行う必要がある

---

## 💡 今回のケースはどっち？

質問から推測すると、**ケース1（同じSupabaseプロジェクト）**の可能性が高いです。

理由：
- 「supabaseのtableとかSQLとか全部同じもの使ってる」という認識がある
- 練習環境でテストした機能が本番でもそのまま使える想定

---

## ✅ ケース1の場合の超簡単な移行手順

### 1. ダウンロード
```
https://github.com/laurel-otoshikomi/record-fishing-practice/archive/refs/heads/main.zip
↑ クリックしてダウンロード
```

### 2. 解凍
```
ZIPファイルを解凍 → record-fishing-practice-main フォルダができる
```

### 3. 不要なフォルダを削除
```
以下のフォルダを削除:
- node_modules/
- dist/
- .git/
```

### 4. ZIPにまとめる
```
record-fishing-practice-main フォルダを右クリック
→「圧縮（zip形式）フォルダー」
```

### 5. 本番アプリのチャットにアップロード
```
【デプロイ依頼文】
━━━━━━━━━━━━━━━━━━━━━
record-fishing アプリを Ver.1.1.0 にアップデートしたいです。
添付のZIPファイルは、練習環境で完成したコードです。

■ 対応内容
1. 添付のZIPファイルを /home/user/webapp/record-fishing に展開
2. npm install を実行
3. npm run build を実行
4. Git commit & push
5. Cloudflare Pages にデプロイ

■ 注意事項
- Supabaseプロジェクトは練習環境と同じものを使用します
- .env ファイルはそのままでOKです
- package.json のバージョンは 1.1.0 です

よろしくお願いします！
━━━━━━━━━━━━━━━━━━━━━

+ ZIPファイルを添付
```

### 6. 動作確認
```
https://record-fishing.pages.dev
↓
Ver.1.1.0 が表示されることを確認
↓
新機能が動作することを確認
```

**終わり！SQL実行は不要！**

---

## 🚨 重要な確認ポイント

### 確認1: 練習環境でテストした時点で、本番データも更新されている？

もし練習環境で以下のことをテストした場合：
- ✅ 新しいエリアを追加した
- ✅ 新しい餌を追加した
- ✅ あたり数を記録した

これらのデータが本番環境でも見えているなら、**ケース1（同じSupabaseプロジェクト）**です。

### 確認2: 練習環境でSQLを実行した？

練習環境でテストする時に、SupabaseのSQL Editorで以下のSQLを実行しましたか？

- `ALTER TABLE logs ADD COLUMN hit_count INTEGER;`
- `ALTER TABLE logs ADD COLUMN size_30 INTEGER DEFAULT 0;`
- `CREATE TABLE baits (...);`

もし実行している場合、**本番Supabaseでも再度SQL実行する必要はありません**！

---

## 📝 まとめ

### ケース1（同じSupabaseプロジェクト）の場合

✅ `.env`ファイルを書き換える必要は**ない**  
✅ SQLを実行する必要は**ない**（すでに練習環境で実行済み）  
✅ コードをアップロードするだけ！

### ケース2（別々のSupabaseプロジェクト）の場合

❌ `.env`ファイルを書き換える必要が**ある**  
❌ 本番SupabaseでSQLを実行する必要が**ある**

---

## ❓ どちらか判断できない場合

以下の質問に答えてください：

1. **Supabaseのプロジェクトはいくつありますか？**
   - 1つだけ → ケース1
   - 2つ以上 → ケース2の可能性

2. **練習環境で記録したデータは、本番環境でも見えますか？**
   - はい → ケース1
   - いいえ → ケース2

3. **練習環境でSupabaseのSQLを実行しましたか？**
   - はい → 本番でもSQL実行不要
   - いいえ → 本番でSQL実行が必要

---

**作成日**: 2026-01-31  
**重要度**: 🔴 超重要  

どちらのケースか教えていただければ、最適な手順を案内します！ 🎣
